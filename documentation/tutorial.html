<html>
<head>
<title>Rescripter - tutorial</title>
<style>
h1 {
	font-family: Courier;
	font-size: 18pt;
	font-weight: normal;
	margin-left: 60px;
	margin-right: 60px;
	background: #AACCFF;
	padding: 12px;
	color: #444488;
	border-radius: 20px;
}

h2 {
	font-family: Arial;
	font-size: 14pt;
	font-weight: normal;
	margin-left: 80px;
	width: 400px;
	padding-bottom: 4px;
	border-bottom: 1px solid #666666;
}

.description {
	font-family: Times New Roman;
	font-size: 12pt;
	color: #444444;
	margin-left: 80px;
	margin-right: 80px;
	margin-bottom: 12px;
}

.description a {
	color: #444488;
}

.code {
	font-family: Courier;
	font-size: 11pt;
	background: #EEEEEE;
	border: 1px dashed #AAAAAA;
	margin-left: 100px;
	margin-right: 100px;
	margin-bottom: 20px;
	padding: 8px;
	white-space: pre;
}

</style>
</head>
<body>
	<h1>rescripter tutorial</h1>

	<h2>Getting Started</h2>
	<div class="description">
		Once you've installed the plugin from the <a href="https://raw.github.com/activelylazy/Rescripter/master/update-site/">update site</a>. Create
		a new file with the extension .rs. To run the script press Ctrl-R S.
	</div>

	<h2>Hello World</h2>
	<div class="description">
		To display messages in your script - e.g. success when you're done (or for primitive debugging).
	</div>
	<div class="code">
Alert.info("Hello world");
	</div>

	<h2>Finding Types</h2>
	<div class="description">
		To find Java types by name
	</div>
	<div class="code">
package com.example.rename;

public class Person {

    public Person() {
        
    }
    
    public String getName() {
        return "Fred";
    }
    
    public static void main(String[] args) {
        Person person = new Person();
        
        System.out.println("The name is "+person.getName());
    }
}
	</div>
	<div class="code">
Alert.info(<b>Find.typeByName("Person")</b>.getFullyQualifiedName());
	</div>
	<div class="description">
		Will popup a message box saying "com.example.Person". Find.typeByName returns an <a href="http://help.eclipse.org/helios/topic/org.eclipse.jdt.doc.isv/reference/api/org/eclipse/jdt/core/IType.html">IType</a>.
	</div>

	<h2>Finding Methods</h2>
	<div class="description">
		There are two ways to find a method on a type. The first is to use <a href="http://help.eclipse.org/helios/topic/org.eclipse.jdt.doc.isv/reference/api/org/eclipse/jdt/core/IType.html#getMethod(java.lang.String, java.lang.String[])">IType.getMethod</a>. Alternatively there's a helper method
		for the simple case where the method isn't overloaded.
	</div>
	<div class="code">
var type = Find.typeByName("Person");
Alert.info(<b>type.getMethod("getName",[])</b>.getElementName());
Alert.info(<b>findMethodByName(type, "getName")</b>.getElementName());
	</div>
	<div class="description">
		Both of these approaches return an <a href="http://help.eclipse.org/helios/topic/org.eclipse.jdt.doc.isv/reference/api/org/eclipse/jdt/core/IMethod.html">IMethod</a>.
	</div>

	<h2>Finding References</h2>
	<div class="description">
		Given a method, the next most interesting thing to do is find all the places its referenced from.
	</div>
	<div class="code">
var type = Find.typeByName("Person");
var method = type.getMethod("getName",[]);
var references = <b>Find.referencesTo(method)</b>;
Alert.info("There are "+references.length+" references to getName()");
	</div>
	<div class="description">
		This tells us that there is just 1 reference. Find.referencesTo returns an array of <a href="http://help.eclipse.org/helios/topic/org.eclipse.jdt.doc.isv/reference/api/org/eclipse/jdt/core/search/SearchMatch.html">SearchMatch</a>.
	</div>

	<h2>Scanning the AST</h2>
	<div class="description">
		The various elements provide a fine-grained view of the source code - but it doesn't always provide enough detail. However, it is possible
		to use Eclipse's AST scanner to further parse the source.
	</div>
	<div class="code">
var type = Find.typeByName("Person");
var method = type.getMethod("getName",[]);
var references = Find.referencesTo(method);
Alert.info(<b>ASTTokenFinder.findTokenOfType</b>(type.getCompilationUnit(), org.eclipse.jdt.core.compiler.ITerminalSymbols.TokenNameLPAREN, 
                                references[0].getOffset(), references[0].getLength()));
	</div>
	<div class="description">
		This searches for references to the getName() method; then for the first reference it builds an AST and scans the
		section of the method call. From this we find the first '(' symbol and show this in the alert box.
		The findTokenOfType method returns a <a href="http://help.eclipse.org/helios/topic/org.eclipse.jdt.doc.isv/reference/api/org/eclipse/jdt/core/SourceRange.html">SourceRange</a> identifying the position of the first matching token.
	</div>

	<h2>Making Changes</h2>
	<div class="description">
		Through Eclipse's plugin environment we have access to various tools that can make changes to code. However, to simplify
		common cases where we want free-form changes there is a helper method.
	</div>
	<div class="code">
var type = Find.typeByName("Person");
var method = type.getMethod("getName",[]);
<b>ChangeText.inCompilationUnit</b>(type.getCompilationUnit(), method.getSourceRange().getOffset(), 0,
                            "/* This is a comment */\n\t"); 
	</div>
	<div class="description">
		This amends the source in Person.java and adds a comment before the getName() method, so we now have:
	</div>
	<div class="code">
    public Person() {
        
    }
    
    <b>/* This is a comment */</b>
    public String getName() {
        return "Fred";
    }
	</div>

</body>
</html>

